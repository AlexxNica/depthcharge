/dts-v1/;
/*
 * NOTE: this needs to align with src/mainboard/google/reef/chromeos.fmd
 * in the coreboot repository. Any changes made there should be reflected
 * in this file. There are parallel notions of fmap information. However,
 * both are used in different parts of the system so the right answer now
 * is to keep them in sync.
 */

/ {
	model = "Google Reef";
	config {
		hwid = "REEF TEST 3240";
	};
	chromeos-config {
		/* Enable factory-friendly features. */
		gbb-flag-dev-screen-short-delay;
		gbb-flag-force-dev-switch-on;
		gbb-flag-force-dev-boot-usb;
		gbb-flag-disable-fw-rollback-check;
	};
	flash@ff800000 {
		#address-cells = <1>;
		#size-cells = <1>;
		compatible = "chromeos,flashmap";
		reg = <0xff800000 0x01000000>;

		/*
		* This describes the portion of the image that will be
		* write-protected in the factory.
		*/
		wp-ro {
			label = "wp-ro";
			reg = <0x00000000 0x00800000>;
			read-only;
		};
		/*
		* Firmware Descriptor section of the Intel Firmware Descriptor
		* image.
		*/
		si-desc {
			label = "si-desc";
			reg = <0x00000000 0x00001000>;
			type = "ifd";
		};
		ro-ifwi {
			label = "ifwi";
			reg = <0x00001000 0x001ff000>;
			read-only;
			required;
			type = "blob ifwi";
		};
		ro-vpd {
			label = "ro-vpd";
			reg = <0x00200000 0x00004000>;
			read-only;
			type = "wiped";
			wipe-value = [ff];
		};

		/* ---- Section: Read-only ---- */
		ro-section {
			label = "ro-section";
			reg = <0x00204000 0x005fc000>;
			read-only;
		};
		ro-fmap {
			label = "fmap";
			/*
			* We encourage to align FMAP partition in as large
			* block as possible so that flashrom can find it soon.
			* For example, aligning to 512KB is better than to
			* 256KB.
			*/

			reg = <0x00204000 0x00000800>;
			read-only;
			type = "fmap";
			ver-major = <1>;
			ver-minor = <0>;
		};
		ro-firmware-id {
			label = "ro-frid";
			reg = <0x00204800 0x00000040>;
			read-only;
			type = "blobstring fwid";
		};
		ro-frid-pad {
			label ="ro-frid-pad";
			reg = <0x00204840 0x000007c0>;
			read-only;
			type = "wiped";
			wipe-value = [ff];
		};
		ro-boot {
			label = "coreboot";
			reg = <0x00205000 0x0017b000>;
			read-only;
			type = "blob coreboot";
			required;
		};
		ro-gbb {
			label = "gbb";
			/* GBB offset must be aligned to 4K bytes */
			reg = <0x00380000 0x00040000>;
			read-only;
			type = "blob gbb";
		};
		ro-unused-1 {
			label ="ro-unused-1";
			reg = <0x003c0000 0x00400000>;
			read-only;
			type = "wiped";
			wipe-value = [ff];
		};
		ro-sig2 {
			label = "sign_cse";
			reg = <0x007c0000 0x00010000>;
			read-only;
			required;
			type = "blob sig2";
		};
		ro-unused-2 {
			label ="ro-unused-2";
			reg = <0x007d0000 0x00030000>;
			read-only;
			type = "wiped";
			wipe-value = [ff];
		};
		/* ---- Section: Rewritable MRC cache 64KB ---- */
		rw-mrc-cache {
			label = "rw-mrc-cache";
			/* Alignment: 4k (for updating) */
			reg = <0x00800000 0x00010000>;
			type = "wiped";
			wipe-value = [ff];
		};
		/* ---- 16k of event log ---- */
		rw-elog {
			label = "rw-elog";
			/* Alignment: 4k (for updating) */
			reg = <0x00810000 0x00004000>;
			type = "wiped";
			wipe-value = [ff];
		};
		/* --- Section: Rewritable shared 16 KB --- */
		shared-section {
			/*
			 * Alignment: 4k (for updating).
			 * Anything in this range may be updated in recovery.
			 */
			label = "rw-shared";
			reg = <0x00814000 0x00004000>;
		};
		shared-data {
			label = "shared-data";
			/*
			 * Alignment: 4k (for random read/write).
			 * RW firmware can put calibration data here.
			 */
			reg = <0x00814000 0x00002000>;
			type = "wiped";
			wipe-value = [00];
		};
		rw-vblock-dev {
			label = "vblock-dev";
			/*
			 * Alignment: 4k (for random read/write).
			 * Reserve space for an optional user-installed
			 * vblock to validate dev-mode kernels.
			 * See crosbug.com/p/11216.
			 */
			reg = <0x00816000 0x00002000>;
			type = "wiped";
			wipe-value = [ff];
		};
		/* ---- Section: Rewritable VPD 8 KB ---- */
		rw-vpd {
			label = "rw-vpd";
			/* Alignment: 4k (for updating) */
			reg = <0x00818000 0x00002000>;
			type = "wiped";
			wipe-value = [ff];
		};
		/* ---- Section: Rewritable slot A ---- */
		rw-a {
			label = "rw-section-a";
			/* Alignment: 4k (for updating) */
			reg = <0x0081a000 0x0028f800>;
		};
		rw-a-vblock {
			label = "vblock-a";
			/*
			 * Alignment: 4k (for updating) and must be in start of
			 * each RW_SECTION.
			 */
			reg = <0x0081a000 0x00010000>;
			type = "keyblock cbfs/rw/a-boot";
			keyblock = "firmware.keyblock";
			signprivate = "firmware_data_key.vbprivk";
			version = <1>;
			kernelkey = "kernel_subkey.vbpubk";
			preamble-flags = <0>;
		};
		rw-a-boot {
			/* Alignment: no requirement (yet). */
			label = "fw-main-a";
			reg = <0x0082a000 0x0027f7c0>;
			type = "blob cbfs/rw/a-boot";
		};
		rw-a-firmware-id {
			/* Alignment: no requirement. */
			label = "rw-fwid-a";
			reg = <0x00aa97c0 0x00000040>;
			read-only;
			type = "blobstring fwid";
		};

		/* ---- Section: Rewritable slot B ---- */
		rw-b {
			label = "rw-section-b";
			/* Alignment: 4k (for updating) */
			reg = <0x00aa9800 0x0028f800>;
		};
		rw-b-vblock {
			label = "vblock-b";
			/*
			 * Alignment: 4k (for updating) and must be in start of
			 * each RW_SECTION.
			 */
			reg = <0x00aa9800 0x00010000>;
			type = "keyblock cbfs/rw/b-boot";
			keyblock = "firmware.keyblock";
			signprivate = "firmware_data_key.vbprivk";
			version = <1>;
			kernelkey = "kernel_subkey.vbpubk";
			preamble-flags = <0>;
		};
		rw-b-boot {
			label = "fw-main-b";
			/* Alignment: no requirement (yet). */
			reg = <0x00ab9800 0x0027f7c0>;
			type = "blob cbfs/rw/b-boot";
		};
		rw-b-firmware-id {
			label = "rw-fwid-b";
			/* Alignment: no requirement. */
			reg = <0x00d38fc0 0x00000040>;
			read-only;
			type = "blobstring fwid";
		};

		/* ---- Section: Storage to simulate NVRAM ---- */
		rw-nvram {
			label = "rw-nvram";
			reg = <0x00d39000 0x00006000>;
			type = "wiped";
			wipe-value = [ff];
		};

		rw-legacy {
			label = "rw-legacy";
			reg = <0x00d3f000 0x00200000>;
			type = "blob legacy";
			read-only;
		};

		/* ---- Last 256KiB of BIOS is unusable. ---- */
		bios-unusable {
			label ="bios-unusable";
			reg = <0x00f3f000 0x00040000>;
			read-only;
			type = "wiped";
			wipe-value = [ff];
		};

		device-extension {
			/* CSE RW data */
			label = "device-extension";
			reg = <0x00f7f000 0x00080000>;
			type = "wiped";
			wipe-value = [ff];
		};

		unused-hole {
			label ="unused-hole";
			reg = <0x00fff000 0x00001000>;
			read-only;
			type = "wiped";
			wipe-value = [ff];
		};
	};
};
